<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOU PARFUMS | Boutique de Luxe</title>
    <link rel="icon" type="image/jpeg" href="https://i.postimg.cc/kg4h2S4b/IMG-20251222-WA0036.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #f68b1e; --black: #1a1a1a; --bg: #f8f8f8; --white: #ffffff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; }
        body { background-color: var(--bg); color: var(--black); }

        /* --- HEADER --- */
        header { background: var(--white); position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .main-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 5%; gap: 20px; }
        .logo-img { height: 55px; cursor: pointer; }
        .search-box { flex-grow: 1; display: flex; max-width: 500px; background: #f1f1f1; border-radius: 6px; }
        .search-box input { width: 100%; padding: 12px; border: none; background: transparent; outline: none; }
        .search-box button { background: var(--primary); border: none; padding: 0 20px; color: white; border-radius: 0 5px 5px 0; }
        .cart-icon { position: relative; cursor: pointer; font-size: 22px; }
        .badge { position: absolute; top: -10px; right: -12px; background: var(--primary); color: white; font-size: 10px; padding: 2px 7px; border-radius: 10px; border: 2px solid white; }

        /* --- NAVIGATION --- */
        .nav-bar { background: var(--white); border-top: 1px solid #f1f1f1; padding: 0 5%; display: flex; gap: 25px; overflow-x: auto; scrollbar-width: none; }
        .nav-bar a { padding: 15px 0; text-decoration: none; color: var(--black); font-size: 13px; font-weight: 600; white-space: nowrap; cursor: pointer; }

        /* --- LAYOUT --- */
        .main-container { display: grid; grid-template-columns: 240px 1fr; gap: 25px; padding: 25px 5%; max-width: 1400px; margin: 0 auto; }
        aside { background: white; padding: 20px; border-radius: 8px; height: fit-content; }
        .side-link { display: block; padding: 12px 0; text-decoration: none; color: #444; font-size: 14px; cursor: pointer; }

        /* --- PRODUCTS --- */
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .card { background: white; padding: 12px; border-radius: 8px; transition: 0.3s; border: 1px solid transparent; }
        .card:hover { border-color: var(--primary); box-shadow: 0 10px 20px rgba(0,0,0,0.08); }
        .card img { width: 100%; height: 260px; object-fit: cover; border-radius: 6px; }
        .p-price { font-size: 18px; font-weight: 700; margin: 10px 0; }
        .btn-buy { width: 100%; background: var(--black); color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: 600; text-transform: uppercase; }

        /* --- CART PANEL --- */
        .cart-panel { position: fixed; right: -100%; top: 0; width: 100%; max-width: 380px; height: 100%; background: white; z-index: 3000; transition: 0.4s; padding: 30px; display: flex; flex-direction: column; box-shadow: -5px 0 15px rgba(0,0,0,0.1); }
        .cart-panel.open { right: 0; }

        /* --- CHECKOUT FORM (الجديد) --- */
        #checkoutForm { margin-top: 20px; display: none; background: #f9f9f9; padding: 15px; border-radius: 8px; }
        .form-input { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px; outline: none; }
        .form-input:focus { border-color: var(--primary); }

        @media (max-width: 900px) { .main-container { grid-template-columns: 1fr; } aside { display: none; } }
    </style>
</head>
<body>

    <header>
        <div class="main-header">
            <img src="https://i.postimg.cc/kg4h2S4b/IMG-20251222-WA0036.jpg" class="logo-img" onclick="renderItems('femme')">
            <div class="search-box">
                <input type="text" id="mainSearch" placeholder="Rechercher un parfum..." oninput="searchLogic()">
                <button><i class="fas fa-search"></i></button>
            </div>
            <div class="header-actions">
                <div class="cart-icon" onclick="toggleCart()">
                    <i class="fas fa-shopping-bag"></i>
                    <span id="cartCount" class="badge">0</span>
                </div>
            </div>
        </div>
        <nav class="nav-bar">
            <a onclick="renderItems('femme')">COLLECTION FEMME</a>
            <a onclick="renderItems('homme')">PARFUMS HOMME</a>
            <a onclick="renderItems('vip')">COFFRETS DE LUXE</a>
        </nav>
    </header>

    <div class="main-container">
        <aside>
            <p style="color:#888; font-size:12px; margin-bottom:10px;">NOS UNIVERS</p>
            <span class="side-link" onclick="renderItems('femme')">Parfums Femme</span>
            <span class="side-link" onclick="renderItems('homme')">Parfums Homme</span>
            <span class="side-link" onclick="renderItems('vip')">Coffrets Cadeaux</span>
        </aside>
        <main>
            <h2 id="catTitle" style="margin-bottom: 20px; font-size: 18px; text-transform: uppercase;">Collection Parfums Femme</h2>
            <div class="products-grid" id="productDisplay"></div>
        </main>
    </div>

    <div class="cart-panel" id="cartPanel">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3>VOTRE PANIER</h3>
            <i class="fas fa-times" onclick="toggleCart()" style="cursor:pointer; font-size: 20px;"></i>
        </div>
        
        <div id="cartList" style="flex-grow:1; overflow-y:auto;"></div>

        <div id="checkoutForm">
            <p style="font-weight:bold; margin-bottom:10px; font-size:14px;">Informations de Livraison :</p>
            <input type="text" id="custName" class="form-input" placeholder="Nom Complet (الاسم الكامل)">
            <input type="tel" id="custPhone" class="form-input" placeholder="N° de Téléphone (رقم الهاتف)">
            <input type="text" id="custAddress" class="form-input" placeholder="Adresse (العنوان)">
        </div>

        <div style="border-top:1px solid #eee; padding-top:20px;">
            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                <span>Total</span>
                <strong id="cartTotal">0 DH</strong>
            </div>
            <button id="mainBtn" class="btn-buy" style="padding:15px; background:var(--black);" onclick="handleOrder()">PASSER LA COMMANDE</button>
        </div>
    </div>

    <script>
        const db = [
            { id: 1, name: "You Signature Gold - Femme", price: 49, cat: "femme", img: "https://i.postimg.cc/MKQ6r5GY/IMG-20251220-WA0143(1).jpg" },
            { id: 2, name: "Prada Luxe Intense Royale", price: 49, cat: "femme", img: "https://i.postimg.cc/m2zkWRmh/IMG-20251220-WA0146.jpg" },
            { id: 3, name: "Hot Premium Men - Black Amber", price: 49, cat: "homme", img: "https://i.postimg.cc/G9wCC0pF/IMG-20251222-WA0037.jpg" },
            { id: 4, name: "Coffret Prestige Luxury", price: 69, cat: "vip", img: "https://i.postimg.cc/KvSjbwwt/IMG-20251222-WA0047.jpg" }
        ];

        let cart = [];

        function renderItems(filter = 'femme') {
            const container = document.getElementById('productDisplay');
            const items = filter === 'all' ? db : db.filter(p => p.cat === filter);
            document.getElementById('catTitle').innerText = "Collection " + filter;
            container.innerHTML = items.map(p => `
                <div class="card">
                    <img src="${p.img}">
                    <div style="font-size:14px; margin-top:10px; height:35px;">${p.name}</div>
                    <div class="p-price">${p.price} DH</div>
                    <button class="btn-buy" onclick="addToCart(${p.id})">Ajouter</button>
                </div>
            `).join('');
        }

        function toggleCart() { document.getElementById('cartPanel').classList.toggle('open'); }

        function addToCart(id) {
            const p = db.find(x => x.id === id);
            cart.push(p);
            updateCartUI();
            if(!document.getElementById('cartPanel').classList.contains('open')) toggleCart();
        }

        function updateCartUI() {
            document.getElementById('cartCount').innerText = cart.length;
            const list = document.getElementById('cartList');
            list.innerHTML = cart.map((item, i) => `
                <div style="display:flex; gap:10px; margin-bottom:15px; align-items:center;">
                    <img src="${item.img}" width="50" style="border-radius:4px;">
                    <div style="flex-grow:1; font-size:13px;"><b>${item.name}</b><br>${item.price} DH</div>
                    <i class="fas fa-trash-alt" style="color:#ddd; cursor:pointer" onclick="cart.splice(${i},1);updateCartUI()"></i>
                </div>
            `).join('');
            const total = cart.reduce((s, i) => s + i.price, 0);
            document.getElementById('cartTotal').innerText = total + " DH";
            
            // إعادة ضبط الزر والاستمارة إذا فرغت السلة
            if(cart.length === 0) {
                document.getElementById('checkoutForm').style.display = 'none';
                document.getElementById('mainBtn').innerText = "PASSER LA COMMANDE";
                document.getElementById('mainBtn').style.background = "var(--black)";
            }
        }

        // دالة التعامل مع الطلب
        function handleOrder() {
            const form = document.getElementById('checkoutForm');
            const btn = document.getElementById('mainBtn');

            if (form.style.display === 'none' || form.style.display === '') {
                // الخطوة 1: إظهار الاستمارة
                if(cart.length === 0) return alert("Votre panier est vide");
                form.style.display = 'block';
                btn.innerText = "CONFIRMER ET ENVOYER (WhatsApp)";
                btn.style.background = "var(--primary)";
            } else {
                // الخطوة 2: التحقق من البيانات ثم الإرسال
                const name = document.getElementById('custName').value;
                const phone = document.getElementById('custPhone').value;
                const addr = document.getElementById('custAddress').value;

                if(!name || !phone || !addr) {
                    alert("Veuillez remplir toutes les informations (المرجو ملء جميع البيانات)");
                    return;
                }

                let msg = `*NOUVELLE COMMANDE YOU PARFUMS*\n\n`;
                msg += `*Infos Client :*\n`;
                msg += `- Nom: ${name}\n`;
                msg += `- Tél: ${phone}\n`;
                msg += `- Adresse: ${addr}\n\n`;
                msg += `*Produits :*\n`;
                cart.forEach(i => msg += `- ${i.name}\n`);
                msg += `\n*TOTAL : ${document.getElementById('cartTotal').innerText}*`;

                window.open(`https://wa.me/212640308709?text=${encodeURIComponent(msg)}`);
            }
        }

        window.onload = () => renderItems('femme');
    </script>
</body>
</html>
